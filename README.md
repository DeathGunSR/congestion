# Network Congestion Prediction using LSTM

This project uses a Long Short-Term Memory (LSTM) neural network to predict network congestion by analyzing `.pcap` traffic files. The system aggregates traffic data into fixed time intervals (default is 5 seconds) and uses a sequence of these intervals to predict future congestion.

## Project Structure

- `pcap_parser.py`: A script to parse a `.pcap` file, aggregate features into 5-second intervals, and save them as a CSV.
- `train_model.py`: A script to train the LSTM model on the aggregated time-series data.
- `predict.py`: A script to make congestion predictions on new `.pcap` files using the trained model.
- `requirements.txt`: A list of all the Python dependencies required for this project.
- `congestion_model.keras`: The saved, trained model file (generated by `train_model.py`).
- `scaler.gz`: The saved scaler object for data normalization (generated by `train_model.py`).

## How to Use

### 1. Installation

First, install the necessary Python libraries:

```bash
pip install -r requirements.txt
```

### 2. Training the Model

You must train the model on your own network traffic data for accurate predictions.

1.  **Place your data:** Put a `.pcap` file containing the traffic you want to train on in the root directory of this project. Let's call it `training_traffic.pcap`.

2.  **Update the parser script:** Open `pcap_parser.py` and change the `PCAP_FILE` variable to match the name of your file.

    ```python
    # in pcap_parser.py
    PCAP_FILE = 'training_traffic.pcap'
    ```

3.  **Run the parser:** Execute the parser script. It will ask for the IP address of the machine where the capture was taken (the "laptop"). This IP is used to calculate RTT correctly.

    ```bash
    python pcap_parser.py
    ```
    This will generate a `processed_data.csv` file, with data aggregated into 5-second intervals.

4.  **Run the training script:** Now, you can train the model on the aggregated data.

    ```bash
    python train_model.py
    ```
    This script trains a new model and saves it as `congestion_model.keras` and the corresponding feature scaler as `scaler.gz`.

### 3. Making a Prediction

Once the model is trained, you can predict congestion on a new `.pcap` file.

```bash
python predict.py /path/to/your/new_capture.pcap --ip YOUR_LAPTOP_IP
```

- Replace `/path/to/your/new_capture.pcap` with the path to your file.
- Replace `YOUR_LAPTOP_IP` with the local IP of the machine where the capture was taken.

The script will process the file, use the last minute of traffic data (12 intervals of 5 seconds) to predict the average RTT in the next 5-second interval, and output a corresponding congestion status.
